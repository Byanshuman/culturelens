<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>CultureLens â€“ Responses</title>

<style>

body{
  margin:0;
  font-family:Segoe UI, Arial;
  background:#0f172a;
  color:white;
}

nav{
  padding:18px 40px;
  font-size:24px;
  font-weight:800;
  border-bottom:1px solid rgba(255,255,255,.2);
}

.container{
  max-width:1100px;
  margin:auto;
  padding:20px;
}

.card{
  background:rgba(255,255,255,.06);
  border:1px solid rgba(255,255,255,.12);
  border-radius:18px;
  padding:18px;
  backdrop-filter:blur(14px);
  box-shadow:0 20px 40px rgba(0,0,0,.35);
}

/* table */
table{
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
}

th,td{
  padding:10px;
  border:1px solid rgba(255,255,255,.2);
}

th{
  background:rgba(255,255,255,.15);
}

/* inputs and buttons */
input{
  width:260px;
  padding:8px;
  border-radius:8px;
  border:none;
}

button{
  padding:10px 16px;
  border:none;
  border-radius:10px;
  cursor:pointer;
  font-weight:700;
}

.primary{
  background:#38bdf8;
  color:black;
}

.primary:hover{
  background:#0ea5e9;
}

</style>
</head>

<body>

<nav>ðŸ“‹ CultureLens â€“ All Responses</nav>

<div class="container">

<div class="card">

  <h2>Review Responses</h2>

  <div style="display:flex;gap:10px;flex-wrap:wrap;">
    <input id="search" placeholder="Search company / user / text..." onkeyup="renderTable()">
    <button class="primary" onclick="exportExcel()">Export to Excel</button>
  </div>

  <table id="responsesTable">
    <thead>
      <tr>
        <th>#</th>
        <th>Company</th>
        <th>Rating</th>
        <th>User</th>
        <th>Review</th>
        <th>Date</th>
      </tr>
    </thead>
    <tbody id="tableBody">
    </tbody>
  </table>

</div>

</div>

<script>

/* Get reviews from localStorage
   (same structure as review.html saved) */
let reviews = JSON.parse(localStorage.getItem("reviews") || "[]");

/* ---------- RENDER TABLE ---------- */
function renderTable(){

  let body = document.getElementById("tableBody");
  let term = document.getElementById("search").value.toLowerCase();

  body.innerHTML = "";

  reviews
    .filter(r =>
      r.company.toLowerCase().includes(term) ||
      r.user.toLowerCase().includes(term) ||
      r.text.toLowerCase().includes(term)
    )
    .forEach((r,i)=>{

      body.innerHTML += `
        <tr>
          <td>${i+1}</td>
          <td>${r.company}</td>
          <td>${r.rating}</td>
          <td>${r.user}</td>
          <td>${r.text}</td>
          <td>${r.time}</td>
        </tr>
      `;
    });
}

renderTable();

/* ---------- EXPORT TO EXCEL ---------- */
/* We'll export table as .xls file (Excel opens it) */

function exportExcel(){

  let table = document.getElementById("responsesTable").outerHTML;
  let file = new Blob([table], {type:"application/vnd.ms-excel"});
  let url = URL.createObjectURL(file);

  let a = document.createElement("a");
  a.href = url;
  a.download = "CultureLens_Responses.xls";
  a.click();
}

</script>

</body>
</html>
